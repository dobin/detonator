{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}
<div class="card card-body">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
            <h2 class="text-2xl font-bold mb-4">Detonator - MalDev Testing Service</h2>
            
            <p class="text-secondary mb-6">
                Submit your RedTeam tools to test them against various EDR's by spinning up VMs.
            </p><p>
                Detonator is a controlled malware detonation platform built for red teamers and offensive security researchers.
            </p><br><p>
                Upload redteaming tools or initial access payload, select an EDR, and Detonator automatically spins up a 
                clean virtual machine with that EDR deployed. The payload is executed in a realistic environment, 
                and Detonator retrieves the EDR's response including: detection status, severity, and more telemetry 
                on what was flagged.
            </p><br><p>
                <b>Test, iterate, and understand EDR behavior without guessing blindly.</b>
            </p><br><p>
                Detonator helps to validate tradecraft, measure detection surface, 
                and refine payloads based on real EDR feedback. Fast, safely, repeatably, and hopefully reproducibly.
            </p><br>
            <p>
                Source:
                <ul class="list-disc list-inside ml-4 space-y-1">
                    <li><a href="https://github.com/dobin/detonator" class="link">Detonator</a></li>
                    <li><a href="https://github.com/dobin/detonatorAgent" class="link">DetonatorAgent</a></li>
                    <li><a href="https://github.com/dobin/rededr" class="link">RedEdr</a></li>
                </ul>
            </p><br>
            <p>
                Note: 
                <ul class="list-disc list-inside ml-4 space-y-1">
                    <li>submitted files are private</li>
                    <li>but the results are public</li>
                    <li>sample submission is off</li>
                </ul>
            </p>
        </div>
        <div class="flex items-center justify-center">
            <img src="{{ url_for('static', filename='detonator1.jpg') }}" alt="Detonator" class="rounded-lg shadow-lg max-w-full h-auto">
        </div>
    </div>
</div>

<script>
    // Check API status on page load
    window.addEventListener('DOMContentLoaded', function() {
        const apiUrl = '{{ API_BASE_URL }}';
        const checkingDiv = document.getElementById('api-status-checking');
        const errorDiv = document.getElementById('api-status-error');
        const urlDisplay = document.getElementById('api-url-display');
        
        fetch(apiUrl + '/api/health', {
            method: 'GET',
            mode: 'cors',
            cache: 'no-cache'
        })
        .then(response => {
            checkingDiv.classList.add('hidden');
            if (! response.ok) {
                errorDiv.classList.remove('hidden');
            }
        })
        .catch(error => {
            checkingDiv.classList.add('hidden');
            errorDiv.classList.remove('hidden');
        });
    });
</script>
{% endblock %}
