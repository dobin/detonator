{% if scan %}
<div class="space-y-4">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div><strong>Scan ID:</strong> {{ scan.id }}</div>
        <div><strong>File ID:</strong> {{ scan.file_id }}</div>
        <div><strong>Status:</strong> <span class="px-2 py-1 rounded text-xs {{ get_status_color(scan.status) }}">{{ scan.status }}</span></div>
        <div><strong>VM Status:</strong> <span class="px-2 py-1 rounded text-xs {{ get_status_color(scan.vm_status) }}">{{ scan.vm_status or 'Not set' }}</span></div>
        <div><strong>Azure Status:</strong> <span class="px-2 py-1 rounded text-xs {{ get_status_color(scan.azure_status) }}">{{ scan.azure_status or 'Not set' }}</span></div>
        <div><strong>VM Template:</strong> {{ scan.vm_template or 'Not set' }}</div>
        <div><strong>EDR Template:</strong> {{ scan.edr_template or 'Not set' }}</div>
        <div><strong>VM Instance:</strong> {{ scan.vm_instance_name or 'Not set' }}</div>
        <div><strong>VM IP:</strong> {{ scan.vm_ip_address or 'Not set' }}</div>
        <div><strong>Result:</strong> {{ scan.result or 'No result yet' }}</div>
    </div>
    
    {% if scan.detonator_srv_logs %}
    <div>
        <strong>Detonator Server Logs:</strong>
        <pre class="bg-gray-100 p-2 rounded text-sm max-h-32 overflow-y-auto" data-scroll-bottom>{{ scan.detonator_srv_logs }}</pre>
    </div>
    {% endif %}
    
    {% if scan.agent_logs %}
    <div>
        <strong>Agent Logs:</strong>
        <pre class="bg-gray-100 p-2 rounded text-sm max-h-32 overflow-y-auto" data-scroll-bottom>{{ scan.agent_logs }}</pre>
    </div>
    {% endif %}
    
    {% if scan.execution_logs %}
    <div>
        <strong>Execution Logs:</strong>
        <pre class="bg-gray-100 p-2 rounded text-sm max-h-32 overflow-y-auto" data-scroll-bottom>{{ scan.execution_logs }}</pre>
    </div>
    {% endif %}
    
    {% if scan.edr_logs %}
    <div>
        <strong>EDR Logs:</strong>
        <pre class="bg-gray-100 p-2 rounded text-sm max-h-32 overflow-y-auto" data-scroll-bottom>{{ scan.edr_logs }}</pre>
    </div>
    {% endif %}
    
    <div class="text-sm text-gray-500">
        <p>Created: {{ scan.created_at|strftime('%Y-%m-%d %H:%M:%S') }}</p>
        <p>Updated: {{ scan.updated_at|strftime('%Y-%m-%d %H:%M:%S') }}</p>
        {% if scan.completed_at %}
        <p>Completed: {{ scan.completed_at|strftime('%Y-%m-%d %H:%M:%S') }}</p>
        {% endif %}
    </div>
</div>

<script>
// Auto-scroll log containers to bottom
const logContainers = document.querySelectorAll('[data-scroll-bottom]');
logContainers.forEach(container => {
    container.scrollTop = container.scrollHeight;
});
</script>
{% else %}
<div class="text-center text-red-500">
    <p>Error: Could not load scan details.</p>
</div>
{% endif %}
